<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <title>í•™ìƒ ìƒë‹´ ì´ë ¥ ë³´ê³ ì„œ</title>
  <style>
    @page {
      size: A4;
      margin: 5mm;
    }

    body {
      font-family: 'Nanum Gothic', sans-serif;
      font-size: 12pt;
      line-height: 1.5;
      color: #333;
    }

    .header {
      text-align: center;
      border-bottom: 2px solid #333;
      padding-bottom: 20px;
      margin-bottom: 30px;
    }

    .header h1 {
      font-size: 24pt;
      font-weight: 900;
      margin: 0;
      color: #2c5aa0;
    }

    .header .subtitle {
      font-size: 14pt;
      color: #666;
      margin-top: 10px;
    }

    .summary-section {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 25px;
      border-radius: 10px;
      margin-bottom: 30px;
    }

    .summary-item {
      flex: 1;
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 8px;
      backdrop-filter: blur(10px);

      border: 2px solid rgba(255, 255, 255, 0.4); /* âœ… ë°˜íˆ¬ëª… í°ìƒ‰ ì„  */
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.2); /* ë‚´ë¶€ ë¼ì¸ ê°•ì¡°ìš© */
    }

    .summary-number {
      font-size: 28pt;
      font-weight: 900;
      display: block;
      margin-bottom: 5px;
    }

    .summary-label {
      font-size: 12pt;
      font-weight: bold;
      opacity: 0.9;
    }

    .period-info {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 25px;
      text-align: center;
    }

    .period-text {
      font-size: 14pt;
      color: #495057;
    }

    .period-dates {
      font-weight: bold;
      color: #2c5aa0;
    }

    .stats-section {
      margin-bottom: 30px;
    }

    .section-title {
      font-size: 16pt;
      font-weight: 800;
      color: #2c5aa0;
      border-bottom: 2px solid #2c5aa0;
      padding-bottom: 8px;
      margin-bottom: 20px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }

    .stat-card {
      background: white;
      border: 1px solid #dee2e6;
      border-left: 4px solid #28a745;
      padding: 15px;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .stat-card:nth-child(2) { border-left-color: #ffc107; }
    .stat-card:nth-child(3) { border-left-color: #dc3545; }
    .stat-card:nth-child(4) { border-left-color: #6f42c1; }

    .stat-category {
      font-weight: 800;
      color: #495057;
      margin-bottom: 5px;
    }

    .stat-count {
      font-size: 20pt;
      font-weight: bold;
      color: #2c5aa0;
    }

    .counsels-section {
      margin-bottom: 30px;
    }

    .counsel-item {
      background: white;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      margin-bottom: 20px;
      overflow: hidden;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      page-break-inside: avoid;
    }

    .counsel-header {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      padding: 15px 20px;
      border-bottom: 1px solid #dee2e6;
    }

    .counsel-content {
      padding: 20px;
    }

    .counsel-text {
      line-height: 1.7;
      margin-bottom: 15px;
    }

    .counsel-outcome {
      background: #f8f9fa;
      border-left: 4px solid #28a745;
      padding: 15px;
      border-radius: 0 6px 6px 0;
      margin-top: 15px;
    }

    .outcome-title {
      font-weight: bold;
      color: #495057;
      margin-bottom: 8px;
    }

    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      text-align: center;
      font-size: 9pt;
      color: #6c757d;
      border-top: 1px solid #dee2e6;
      padding-top: 10px;
      background-color: white;
    }

    .page-break {
      page-break-before: always;
    }

    /* í”„ë¦°íŠ¸ ìµœì í™” */
    @media print {
      .footer {
        position: fixed;
        bottom: 0;
      }

      .counsel-item {
        page-break-inside: avoid;
      }
    }

    /* ë¹ˆ ë°ì´í„° ì²˜ë¦¬ */
    .no-data {
      text-align: center;
      padding: 40px;
      color: #6c757d;
      font-style: italic;
    }
  </style>
</head>
<body>
<!-- í—¤ë” -->
<div class="header">
  <h1>í•™ìƒ ìƒë‹´ ì´ë ¥ ë³´ê³ ì„œ</h1>
  <div class="subtitle">Student Counseling History Report</div>
</div>

<!-- ìš”ì•½ ì •ë³´ -->
<!-- ìš”ì•½ ì •ë³´: tableë¡œ 3ì¹¸ ë°°ì¹˜ ë³´ì¥ -->
<div class="summary-section">
  <table style="width: 100%; text-align: center;">
    <tr>
      <td>
        <div class="summary-number" th:text="${totalCounselCount}">12</div>
        <div class="summary-label">ì´ ìƒë‹´ íšŸìˆ˜</div>
      </td>
      <td>
        <div class="summary-number" th:text="${#maps.size(categoryStats)}">4</div>
        <div class="summary-label">ìƒë‹´ ìœ í˜• ìˆ˜</div>
      </td>
      <td>
        <div class="summary-number" th:text="${studentName}">í™ê¸¸ë™</div>
        <div class="summary-label">í•™ìƒëª…</div>
      </td>
    </tr>
  </table>
</div>

<!-- ê¸°ê°„ ì •ë³´ -->
<div class="period-info">
  <div class="period-text">
    ìƒë‹´ ê¸°ê°„:
    <span class="period-dates" th:text="${periodStart}">2025ë…„ 03ì›” 01ì¼</span> ~
    <span class="period-dates" th:text="${periodEnd}">2025ë…„ 06ì›” 02ì¼</span>
  </div>
</div>

<!-- ì¹´í…Œê³ ë¦¬ë³„ í†µê³„ -->
<div class="stats-section">
  <div class="section-title">ìƒë‹´ ìœ í˜•ë³„ í†µê³„</div>
  <div class="stats-grid">
    <div class="stat-card" th:each="stat : ${categoryStats}">
      <div class="stat-category" th:text="${stat.key}">í•™ìŠµìƒë‹´</div>
      <div class="stat-count" th:text="${stat.value} + 'íšŒ'">5íšŒ</div>
    </div>
  </div>
</div>

<!-- ìƒë‹´ ì´ë ¥ ìƒì„¸ -->
<div class="counsels-section">
  <div class="section-title">ìƒë‹´ ì´ë ¥ ìƒì„¸</div>

  <!-- ìƒë‹´ ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš° -->
  <div th:if="${counsels != null and #lists.size(counsels) > 0}">
    <div class="counsel-item" th:each="counsel, iterStat : ${counsels}">
      <div class="counsel-header">
        <table style="width: 100%; border-collapse: collapse;">
          <tr>
            <td style="font-size: 14pt; font-weight: bold; color: #2c5aa0;">
              [[${#temporals.format(counsel.dateTime, 'yyyyë…„ MMì›” ddì¼')}]]
            </td>
            <td style="text-align: center;">
      <span style="background: #e3f2fd; color: #1976d2; padding: 5px 12px; border-radius: 20px; font-weight: bold;">
        [[${counsel.category}]]
      </span>
            </td>
            <td style="text-align: right; color: #495057; font-size: 10pt;">
              ë‹´ë‹¹: [[${counsel.teacher.name}]]
            </td>
          </tr>
        </table>
      </div>

      <div class="counsel-content">
        <div class="counsel-text" th:text="${counsel.content}">
          í•™ìƒì´ ìµœê·¼ ìˆ˜í•™ ê³¼ëª©ì—ì„œ ì–´ë ¤ì›€ì„ ê²ªê³  ìˆì–´ ìƒë‹´ì„ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.
          êµ¬ì²´ì ìœ¼ë¡œ í•¨ìˆ˜ ë‹¨ì›ì—ì„œ ì´í•´ë„ê°€ ë–¨ì–´ì§€ëŠ” ê²ƒìœ¼ë¡œ íŒŒì•…ë˜ì—ˆìŠµë‹ˆë‹¤.
        </div>

        <div class="counsel-outcome" th:if="${counsel.nextPlan != null and counsel.nextPlan != ''}">
          <div class="outcome-title"> ìƒë‹´ ê²°ê³¼ ë° ê³„íš</div>
          <div th:text="${counsel.nextPlan}">
            ë°©ê³¼í›„ ìˆ˜í•™ ë³´ì¶©í•™ìŠµ ì°¸ì—¬ë¥¼ ê¶Œì¥í•˜ë©°, ì£¼ 2íšŒ ê°œë³„ í•™ìŠµ ì ê²€ì„ ì‹¤ì‹œí•  ì˜ˆì •ì…ë‹ˆë‹¤.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ìƒë‹´ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° -->
  <div th:if="${counsels == null or #lists.size(counsels) == 0}" class="no-data">
    <h3>ğŸ“‹ ìƒë‹´ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤</h3>
    <p>í˜„ì¬ ë“±ë¡ëœ ìƒë‹´ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
  </div>
</div>

<!-- í‘¸í„° -->
<div class="footer">
  <div>ë³¸ ë¬¸ì„œëŠ” <span th:text="${generatedDate}">2025ë…„ 06ì›” 02ì¼ 15ì‹œ 30ë¶„</span>ì— ì „ìì ìœ¼ë¡œ ìƒì„±ëœ ìƒë‹´ ì´ë ¥ ë³´ê³ ì„œì…ë‹ˆë‹¤.</div>
  <div>ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ë‹´ë‹¹êµì‚¬ì—ê²Œ ì—°ë½ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.</div>
</div>
</body>
</html>